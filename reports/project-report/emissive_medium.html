<!DOCTYPE html
    PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="images/favicon.ico" />

    <title>Computer Graphics - Final Project</title>

    <link href="resources/bootstrap.min.css" rel="stylesheet">
    <link href="resources/offcanvas.css" rel="stylesheet">
    <link href="resources/twentytwenty.css" rel="stylesheet" type="text/css" />
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
    <nav class="navbar bg-dark navbar-expand-lg navbar-dark fixed-top">
        <a class="navbar-brand" href="enori.html">ENori</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarContent"
            aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div id="navbarContent" class="collapse navbar-collapse">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                    <a class="nav-link" href="index.html">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="enori.html">ENori</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMatthias" role="button"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Matthias
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMatthias">
                        <a class="dropdown-item" href="adaptive.html">Adaptive Sampling</a>
                        <a class="dropdown-item" href="disney.html">Disney BSDF</a>
                        <a class="dropdown-item" href="envmap.html">Environment Map Emitter</a>
<a class="dropdown-item" href="emitters.html">Extra Emitter</a>
                        <a class="dropdown-item" href="images.html">Images as Textures</a>
                        <a class="dropdown-item" href="denoising.html">Simple Denoising</a>
                    </div>
                </li>
                <li class="nav-item dropdown active">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownRoger" role="button"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Roger
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownRoger">
                        <a class="dropdown-item" href="anisotropic.html">Anisotropic Phase Function</a>
                        <a class="dropdown-item" href="blender.html">Blender</a>
                        <a class="dropdown-item" href="dof.html">Depth of Field</a>
                        <a class="dropdown-item active" href="emissive_medium.html">Emissive Participating Media</a>
                        <a class="dropdown-item" href="heterogenous_media.html">Hetergoenous Participating Media</a>
                        <a class="dropdown-item" href="normals.html">Normal Mapping</a>
                        <a class="dropdown-item" href="misc-roger.html">Misc</a>
                    </div>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container headerBar">
        <h1>Emissive Participating Media (Roger, 10pt)</h1>
    </div>

    <div class="container contentWrapper">
        <div class="pageContent">

            <!-- ================================================================= -->
            <p>
                I based this feature on the arealight, where instead of sampling the shape surface we sample its volume.
                The pdf function is the same except that we query the volume. As we are sampling a point uniformly inside the volume, the pdf=1/volume. 
                As calculating the volume is non-trivial for arbitrary triangle meshes, I have only implemented this feature for the sphere and AABB. <br/><br/>

                Volume lights are attached to a medium. This means that a shape can have a surface and medium emitter simultaneously.<br/>

                We also do not have a normal inside the volume and thus assume that the light is emitted with the same strenth in all directions (isotropic in this respect).<br/><br/>

                I initialliy started by implementing the sampling and pdf like pointlights without integrating the radiance along a ray. 
                This gave good results for the MATS integrator (path_vol_mats) but not for the MIS integrator (path_vol_mis), see below.
                Later I realized that the radiance also needs to be accumulated when a ray travels through the medium. 
                This is partially complete inside the HeterogeneousMedium::getTransmittance function where we accumulate the emission from temperature.
            </p>
                
            <h4>Comparison 128spp</h4>
            <div class="twentytwenty-container">
                <img src="images/emissive-media/volumelight-test-mats.png" alt="Mine MATS" class="img-responsive">
                <img src="images/emissive-media/volumelight-test-mis.png" alt="Mine MIS" class="img-responsive">
                <img src="images/emissive-media/volumelight-test-ref.png" alt="Blender" class="img-responsive">
            </div> <br>
            <p>Mine is significantly more noisy with only mats sampling. MIS sampling is incorrect.</p>

            <h4>Emissive surface+media 128spp</h4>
            <div class="twentytwenty-container">
                <img src="images/emissive-media/volumelight-test-with-surface-mats.png" alt="Mine MATS" class="img-responsive">
                <!-- <img src="images/emissive-media/volumelight-test-with-surface-mis.png" alt="Mine MIS" class="img-responsive"> -->
                <img src="images/emissive-media/volumelight-test-with-surface-ref.png" alt="Blender" class="img-responsive">
            </div> <br>


            <h4>Implemented in:</h4>
            <ul>
                <li>src/emitter/volumelight.cpp</li>
                <li>src/mediua/homogeneous.cpp</li>
                <li>src/mediua/heterogeneous.cpp</li>
                <li>include/nori/medium.h</li>
                <li>src/integrators/path_vol_mats.cpp</li>
                <li>src/integrators/path_vol_mis.cpp</li>

            </ul>
        </div>
    </div>


    <!-- Bootstrap core JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="resources/bootstrap.min.js"></script>
    <script src="resources/jquery.event.move.js"></script>
    <script src="resources/jquery.twentytwenty.js"></script>

    <script>
        $(window).load(function () { $(".twentytwenty-container").twentytwenty({ default_offset_pct: 0.5 }); });
    </script>

</body>

</html>